if(document.all&&!document.getElementById){document.getElementById=function(a){return document.all[a]}}function BlockSubmit(b,c){var a=b.keyCode||b.which;if(a==13){c();return false}else{return true}}function CheckAll(b){var a=Explode(b,",");for(j=0;j<a.length;j++){CheckSwitch(a[j],true)}}function CheckNone(b){var a=Explode(b,",");for(j=0;j<a.length;j++){CheckSwitch(a[j],false)}}function CheckSwitch(c,a){var b=document.getElementsByTagName("input");for(i=0;i<b.length;i++){if(b[i].type=="checkbox"&&b[i].id.indexOf(c)==0){b[i].checked=a}}}function ClearContents(a){if(a){a.innerHTML=""}}function CompletePreferenceSet(b){var a=document.getElementById(b);if(a){a.className="PreferenceComplete"}}function Definition(f,h){var d,b,g,c,k=Definition._cache;if(k===d&&document.getElementsByTagName){k=Definition._cache={};b=document.getElementsByTagName("meta");for(var e=0,a=b.length;e<a;e++){g=b[e].name||b[e].getAttribute("name")||"";c=b[e].content||b[e].getAttribute("content")||"";if(g.substring(0,10)==="X-Vanilla-"){k[g.substring(10)]=c}}}if(h!==d){k[f]=h}return k[f]}function Explode(b,a){return b.split(a)}function Focus(a){var b=document.getElementById(a);if(b){b.focus()}}function GetElements(a,b){var d=document.getElementsByTagName(a);var c=new Array();for(i=0;i<d.length;i++){if(d[i].id.indexOf(b)==0){c[c.length]=d[i]}}return c}function HideElement(a,c){var b=document.getElementById(a);if(b){b.style.display="none";if(c==1){ClearContents(b)}}}function PathFinder(){this.params=new function(){this.url=document.URL;this.domain=document.domain;this.httpMethod=this.url.replace(/^(http|https)(:\/\/).*$/,"$1$2");return this};this.getRootPath=function(c,b,f){var a=document.getElementsByTagName(c);var g="";var d="";for(var e=0;e<a.length;e++){g="";if(a[e].getAttribute&&a[e].getAttribute(b)){g=a[e].getAttribute(b)}else{if(a[e][b]){g=a[e][b]}}if(g.match(f)){d=g.replace(f,"");d=d.replace(/^http(s)?:\/\/[^\/]+/,"");break}}return d||false};return this}function PopTermsOfService(a){window.open(a,"TermsOfService","toolbar=no,status=yes,location=no,menubar=no,resizable=yes,height=600,width=400,scrollbars=yes")}function PreferenceSet(a){setTimeout("CompletePreferenceSet('"+this.Param+"');",400)}function RefreshPage(a){if(!a){a=400}setTimeout("document.location.reload();",a)}function RefreshPageWhenAjaxComplete(a){RefreshPage()}function SubmitForm(c,a,b){Wait(a,b);document[c].submit()}function SwitchElementClass(c,f,a,g,e,d){var b=document.getElementById(c);Sender=document.getElementById(f);if(b&&Sender){if(b.className==g){b.className=a;Sender.innerHTML=e}else{b.className=g;Sender.innerHTML=d}}}function SwitchExtension(e,f,d){var c=document.getElementById(f);if(c){c.className="Processing"}var b="ExtensionKey="+f+"&PostBackKey="+d;var a=new DataManager();a.Param=f;a.RequestFailedEvent=SwitchExtensionResult;a.RequestCompleteEvent=SwitchExtensionResult;a.LoadData(e+"?"+b)}function SwitchExtensionResult(b){var a=document.getElementById(Trim(b.responseText));if(a){setTimeout("SwitchExtensionItemClass('"+Trim(b.responseText)+"')",400)}else{alert(Trim(b.responseText))}}function SwitchExtensionItemClass(c){var b=document.getElementById(c);var a=document.getElementById("chk"+c+"ID");if(b&&a){b.className=a.checked?"Enabled":"Disabled"}}function SwitchPreference(g,f,c,e){var a=document.getElementById(f);var d=document.getElementById(f+"ID");if(d&&a){a.className="PreferenceProgress";var b=new DataManager();b.Param=f;b.RequestFailedEvent=HandleFailure;if(c==1){b.RequestCompleteEvent=RefreshPageWhenAjaxComplete}else{b.RequestCompleteEvent=PreferenceSet}b.LoadData(g+"?Type="+f+"&PostBackKey="+e+"&Switch="+d.checked)}}function Trim(a){return a.replace(/^\s*|\s*$/g,"")}function UpdateCheck(d,b,c){var a=new DataManager();a.RequestCompleteEvent=UpdateCheckStatus;a.RequestFailedEvent=UpdateCheckStatus;a.Param=d;a.LoadData(d+"?RequestName="+b+"&PostBackKey="+c)}function UpdateCheckStatus(e){if(e.responseText=="COMPLETE"){return}var f=e.responseText.substring(0,e.responseText.indexOf("|"));if(f=="First"){var b=document.getElementById("Core");var g=document.getElementById("CoreDetails")}else{var b=document.getElementById(f);var g=document.getElementById(f+"Details")}var d=e.responseText.slice(e.responseText.indexOf("|")+1);var a=document.getElementById("FormPostBackKey");var c=(a)?a.value:"";if(b&&g){if(d.indexOf("ERROR]")==1){b.className="UpdateError";g.innerHTML=d.replace(/\[ERROR\]/g,"")}else{if(d.indexOf("OLD]")==1){b.className="UpdateOld"}else{if(d.indexOf("UNKNOWN]")==1){b.className="UpdateUnknown"}else{b.className="UpdateGood"}}g.innerHTML=d.replace(/\[OLD\]/g,"").replace(/\[UNKNOWN\]/g,"").replace(/\[GOOD\]/g,"");setTimeout("UpdateCheck('"+this.Param+"', '"+f+"', '"+c+"');",300)}}else{alert("Error: "+e.responseText)}}function Wait(a,c){a.disabled=true;a.value=c;var b=a.parentNode;while(b!=null){if(b.tagName=="FORM"){b.submit();break}b=b.parentNode}}function WriteEmail(d,b,g,a){if(document.createElement&&document.getElementById){var e,c,f;e=document.createElement("a");e.href="mailto:"+b+"@"+d;g=g||b+"@"+d;f=document.createTextNode(g);e.appendChild(f);c=document.getElementById(a);if(c){c.parentNode.appendChild(e)}}}function showById(a){document.getElementById(a).style.display="block"}(function(b){b.ScrollFixedPosition={panel:function(){var d=b(window).scrollTop();var a=b("#Panel").offset();var c=b("#Body").offset();if(d>a.top){b("#Panel").css("position","fixed");b("#Panel").css("top","0");b("#BackToDiscussions").slideDown("fast");b("#TopOfPage").slideDown("fast")}else{if(d<=c.top){b("#Panel").css("position","");b("#Panel").css("top","");b("#BackToDiscussions").slideUp("fast");b("#TopOfPage").slideUp("fast")}}}};b(window).bind("scroll",b.ScrollFixedPosition.panel)})(jQuery.noConflict());